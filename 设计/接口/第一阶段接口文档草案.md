# 第一阶段接口文档草案

Host: http://xxx.xxx.xxx.xxx

## 账户

### 登录

Request:

URL: `/login` 

POST

```javascript
post_data = {
    'account': 'balabala',
    'passwd': 'ba1aba1aba1aba1aba1aba1aba1aba1a'  // 32位MD5
}
```



Response:

- 用户不存在
- 密码错误
- 成功：`"type":"student/instructor/leader/admin", 200` （参照数据库中的账户类型说明，返回字符串）
- 400 type error
- 404 no account
- 403 password error



通过session记录登录状态



### 修改密码

Request:

URL: `/change_passwd`

POST

```javascript
post_data = {
    'old_password': 'ba1aba1aba1aba1aba1aba1aba1aba11',  // 32位MD5
    'new_password': 'ba1aba1aba1aba1aba1aba1aba1aba1a'  // 32位MD5
}
```



Response:

- 未登录 `404`
- 旧密码错误 `403`
- 成功：`200`
- 万一没账号呢 `{'message': 'no account'} 404`



### 登出

Request:

URL: `/logout`

GET



Response:

- 未登录 `404`
- 成功：`200`
- 其他



## 学生端功能

### 获取课表

Request:

URL: `/stu_mine_class`

GET



Response:

- 未登录
- 成功：`JSON, 200`

```javascript
JSON = [
    {
        'course_id': '',
        'course_name': '',
        'instructor_name': ['', ''],  // 如果有多位老师
        'classroom_id': '',
        'week': '',
        'day': '',
        'section': ''
    },
    // {...},
]
```

- 其他



### 获取成绩单

Request:

URL: `/stu_mine_grade`

GET



Response:

- 未登录
- 成功：`JSON, 200`

```javascript
JSON = [
    {
        'course_id': '',
        'name': '',  // 课程名
        'type': '',  // 课程属性
        'credit': '',
        'grade': ''
    },
    // {...},
]
```

- 其他



### 查看可选课信息

Request:

URL: `/stu_class_list`

GET



Response:

- 未登录
- 成功：`JSON, 200`

```javascript
JSON = [
    {
        'class_id': '',
        'course_id': '',
        'course_name': '',
        'type': '',  // 课程属性
        'credit': '',
        'period': '',
        'instructor_name': ['', ''],
        'classroom_id': '',
        'day': ['', ''],  // 如果一周要上多节
    },
    // {...},
]
```

- 其他



### 选课

Request:

URL: `/stu_choice_class`

GET

```javascript
get_data = {'class_id': ''}
```



Response:

- 未登录：
- 已选：
- 成功：`200`
- 不能选课
- 其他



### 查看考试信息

Request:

URL: `/exam_info`

GET



Response:

- 未登录：
- 成功：`JSON, 200`

```javascript
JSON = [
    {
        'course_name': '',
        'classroom_id': '',
        'date': '',
        'time': '',
        'exam_grade': ''
    },
    // {...},
]
```

- 其他



## 教师端功能

### 获取所授课程信息

Request:

URL: `/tea_class_info`

GET



Response:

- 未登录：
- 成功：`JSON, 200`

```javascript
JSON = [
    {
        'class_id': '',
        'course_id': '',
        'course_name': '',
        'type': '',  // 课程属性
        'classroom_id': '',
        'day': ['', ''],  // 如果一周要上多节
    },
    // {...},
]
```

- 其他



### 获取某教学班学生名单

Request:

URL: `/tea_class_info`

GET

```javascript
get_data = {'class_id': ''}
```



Response:

- 未登录：
- 成功：`JSON, 200`

```javascript
JSON = [
    {
        'student_id': '',
        'student_name': '',
        'grade': ''
    },
    // {...},
]
```

- 该课程任课老师不是你
- 其他



### 录成绩

Request:

URL: `/tea_insert_grade`

POST

```javascript
get_data = {
    'class_id': ''
}
```



Response:

- 未登录：
- 成功：`200`
- 该课程任课老师不是你

- 其他



### 获取考试安排

**\*与学生的接口完全相同**

Request:

URL: `/exam_info`

GET



Response:

- 未登录：
- 成功：`JSON, 200`

```javascript
JSON = [
    {
        'course_name': '',
        'classroom_id': '',
        'date': '',
        'time': '',
        'exam_grade': ''
    },
    // {...},
]
```

- 其他



## 系统管理员

### 获取表名列表

Request:

URL: `/root_show_tables`

GET



Response:

- 未登录：
- 成功：`JSON, 200`

```javascript
JSON = [
    'table_name1',
    'table_name2',
    // ...
]
```

- 其他



### 获取某表

Request：

URL:`/root_get_table`

GET

```javascript
get_data = {'table_name': ''}
```



Response:

- 未登录：
- 成功：`JSON, 200`

```javascript
JSON = {
    'format': ['col_name1', 'col_name2', '...'],  // 每一列的列名, 主键放在第一列
    'data': [
        ['row1_col1', 'row1_col2', 'row1_col3', 'row1_...'],
        ['row2_col1', 'row2_col2', 'row2_col3', 'row2_...'],
        // [...],
}
```

- 其他



### 修改某表

Request:

URL: `/root_change_table`

POST

```javascript
post_data = {
    'table_name': '',
    'type': '',  // 'DELETE', 'INSERT'或 'UPDATE'
    'primary_key': '',  // 一个主键的值，用于'DELETE'、'UPDATE'操作的WHERE字句做比较，'INSERT'的话这个值为空
    'data': ['col1', 'col2', '...']  // 用于'UPDATE'或'INSERT'插入或修改的数据，'DELETE'的话该值为空
}
```

